<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="I Made Nusa Yudiskara">
<meta name="dcterms.date" content="2022-09-18">
<meta name="description" content="Artikel ini membahas tentang cara sebuah gagasan dan pendekatan sederhana untuk membuat sebuah OCR (Optical Character Recognition) untuk melakukan extraksi text dari sebuah gambar catatan/halaman yang ditulis tangan.">

<title>I Made Nusa Yudiskara - Optical Character Recognition Untuk Gambar Dengan Tulisan Tangan Menggunakan Tensorflow</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">I Made Nusa Yudiskara</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html">About</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/nusa1890"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/NusaYudiskara"><i class="bi bi-twitter" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Optical Character Recognition Untuk Gambar Dengan Tulisan Tangan Menggunakan Tensorflow</h1>
                  <div>
        <div class="description">
          Artikel ini membahas tentang cara sebuah gagasan dan pendekatan sederhana untuk membuat sebuah OCR (Optical Character Recognition) untuk melakukan extraksi text dari sebuah gambar catatan/halaman yang ditulis tangan.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">jupyter</div>
                <div class="quarto-category">code</div>
                <div class="quarto-category">classification</div>
                <div class="quarto-category">image recognition</div>
                <div class="quarto-category">tensorflow</div>
                <div class="quarto-category">data cleaning</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>I Made Nusa Yudiskara </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">September 18, 2022</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="optical-character-recognition-untuk-gambar-dengan-tulisan-tangan-menggunakan-tensorflow" class="level1">
<h1>Optical Character Recognition Untuk Gambar Dengan Tulisan Tangan Menggunakan Tensorflow</h1>
<section id="artikel-ini-membahas-tentang-cara-sebuah-gagasan-dan-pendekatan-sederhana-untuk-membuat-sebuah-ocr-optical-character-recognition-untuk-melakukan-extraksi-text-dari-sebuah-gambar-catatanhalaman-yang-ditulis-tangan." class="level3">
<h3 class="anchored" data-anchor-id="artikel-ini-membahas-tentang-cara-sebuah-gagasan-dan-pendekatan-sederhana-untuk-membuat-sebuah-ocr-optical-character-recognition-untuk-melakukan-extraksi-text-dari-sebuah-gambar-catatanhalaman-yang-ditulis-tangan.">Artikel ini membahas tentang cara sebuah gagasan dan pendekatan sederhana untuk membuat sebuah OCR (Optical Character Recognition) untuk melakukan extraksi text dari sebuah gambar catatan/halaman yang ditulis tangan.</h3>
</section>
<section id="apa-itu-optical-character-recognition-ocr" class="level2">
<h2 class="anchored" data-anchor-id="apa-itu-optical-character-recognition-ocr">Apa itu Optical Character Recognition (OCR)?</h2>
<p>Optical Character Recognition adalah konversi otomatis teks dalam gambar menjadi kode huruf yang dapat digunakan dalam komputer dan aplikasi pemrosesan teks. Secara sederhana, ini adalah ekstraksi teks dari sebuah catatan/halaman dengan tulisan tangan dengan menggunakan alat seperti stylus, pensil ,pena ,dll.</p>
</section>
<section id="cara-kerja" class="level2">
<h2 class="anchored" data-anchor-id="cara-kerja">Cara Kerja</h2>
<ul>
<li><strong>1</strong> : Buat sebuah classifier digit (0-9) dan huruf (A-Z + a-z) menggunakan arsitektur cnn</li>
<li><strong>2</strong> : Terapkan segmentasi pada setiap huruf pada kata yang telah ditulis</li>
<li><strong>3</strong> : Klasifikasi setiap segment huruf kemudian dapatkan kata akhir dari gambar tersebut.</li>
</ul>
<p>::: {.cell _cell_guid=‘79c7e3d0-c299-4dcb-8224-4455121ee9b0’ _uuid=‘d629ff2d2480ee46fbb7e2d37f6b5fab8052498a’ execution=‘{“iopub.execute_input”:“2022-11-09T13:40:57.327363Z”,“iopub.status.busy”:“2022-11-09T13:40:57.326909Z”,“iopub.status.idle”:“2022-11-09T13:40:57.334193Z”,“shell.execute_reply”:“2022-11-09T13:40:57.333292Z”,“shell.execute_reply.started”:“2022-11-09T13:40:57.327330Z”}’ trusted=‘true’ execution_count=11}</p>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import Library</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.preprocessing.image <span class="im">import</span> ImageDataGenerator</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cv2</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> imutils</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelBinarizer</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.utils <span class="im">import</span> np_utils</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.models <span class="im">import</span> Sequential</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras <span class="im">import</span> optimizers</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelBinarizer</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras <span class="im">import</span> backend <span class="im">as</span> K</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.layers <span class="im">import</span> Dense, Activation, Flatten, Dense,MaxPooling2D, Dropout</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.layers <span class="im">import</span> Conv2D, MaxPooling2D, BatchNormalization</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>:::</p>
<p>Dari data train hanya gunakan gambar (A-Z + a-z) dan 0-9. Kemudian ubah setiap nilai pixel pada gambar menjadi ke bentuk array</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-11-09T13:40:57.339893Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-11-09T13:40:57.339488Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-11-09T14:01:40.333976Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-11-09T14:01:40.333064Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-11-09T13:40:57.339857Z&quot;}" data-trusted="true" data-execution_count="12">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="bu">dir</span> <span class="op">=</span> <span class="st">"../input/handwritten-characters/Train/"</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> []</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>img_size <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>non_chars <span class="op">=</span> [<span class="st">"#"</span>,<span class="st">"$"</span>,<span class="st">"&amp;"</span>,<span class="st">"@"</span>]</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> os.listdir(<span class="bu">dir</span>):</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="kw">in</span> non_chars:</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    sub_directory <span class="op">=</span> os.path.join(<span class="bu">dir</span>,i)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> os.listdir(sub_directory):</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>        count<span class="op">+=</span><span class="dv">1</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> count <span class="op">&gt;</span> <span class="dv">4000</span>:</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>        img <span class="op">=</span> cv2.imread(os.path.join(sub_directory,j),<span class="dv">0</span>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>        img <span class="op">=</span> cv2.resize(img,(img_size,img_size))</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>        train_data.append([img,i])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-11-09T14:01:40.338675Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-11-09T14:01:40.338391Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-11-09T14:01:40.347922Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-11-09T14:01:40.347251Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-11-09T14:01:40.338649Z&quot;}" data-trusted="true" data-execution_count="13">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(train_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>140000</code></pre>
</div>
</div>
<p>Lakukan hal yang sama pada data validation</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-11-09T14:01:40.349857Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-11-09T14:01:40.349624Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-11-09T14:04:03.112404Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-11-09T14:04:03.111400Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-11-09T14:01:40.349835Z&quot;}" data-trusted="true" data-execution_count="14">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>val_dir <span class="op">=</span> <span class="st">"../input/handwritten-characters/Validation/"</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>val_data <span class="op">=</span> []</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>img_size <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> os.listdir(val_dir):</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="kw">in</span> non_chars:</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    sub_directory <span class="op">=</span> os.path.join(val_dir,i)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> os.listdir(sub_directory):</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>        count<span class="op">+=</span><span class="dv">1</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> count <span class="op">&gt;</span> <span class="dv">1000</span>:</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>        img <span class="op">=</span> cv2.imread(os.path.join(sub_directory,j),<span class="dv">0</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>        img <span class="op">=</span> cv2.resize(img,(img_size,img_size))</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>        val_data.append([img,i])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-11-09T14:04:03.115259Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-11-09T14:04:03.114882Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-11-09T14:04:03.131713Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-11-09T14:04:03.130482Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-11-09T14:04:03.115221Z&quot;}" data-trusted="true" data-execution_count="15">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(val_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>15209</code></pre>
</div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-11-09T14:04:03.135658Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-11-09T14:04:03.135324Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-11-09T14:04:03.281757Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-11-09T14:04:03.281097Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-11-09T14:04:03.135626Z&quot;}" data-trusted="true" data-execution_count="16">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Shuffle atau acak setiap data yang ada pada train dan validation</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>random.shuffle(train_data)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>random.shuffle(val_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-11-09T14:04:03.284985Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-11-09T14:04:03.284640Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-11-09T14:04:03.344899Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-11-09T14:04:03.344283Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-11-09T14:04:03.284950Z&quot;}" data-trusted="true" data-execution_count="17">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pisahkan nilai fitur dan label pada data train menjadi train_X untuk fitur dan train_Y untuk label</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>train_X <span class="op">=</span> []</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>train_Y <span class="op">=</span> []</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> features,label <span class="kw">in</span> train_data:</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    train_X.append(features)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    train_Y.append(label)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-11-09T14:04:03.346550Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-11-09T14:04:03.346205Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-11-09T14:04:03.362277Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-11-09T14:04:03.361515Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-11-09T14:04:03.346506Z&quot;}" data-trusted="true" data-execution_count="18">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pisahkan nilai fitur dan label pada data validation menjadi val_X untuk fitur dan val_Y untuk label</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>val_X <span class="op">=</span> []</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>val_Y <span class="op">=</span> []</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> features,label <span class="kw">in</span> val_data:</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    val_X.append(features)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    val_Y.append(label)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Transformasi label ke bentuk biner dengan menggunakan <code>LabelBinarizer()</code> fungsi untuk mempercepat proses komputasi Pada kasus ini terdapat 62 : * A = [1, 0, 0, … ,0] * B = [0, 1, 0, … ,0] * C = [0, 0, 1, … ,0] * dst</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-11-09T14:04:03.364135Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-11-09T14:04:03.363666Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-11-09T14:04:03.559368Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-11-09T14:04:03.558542Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-11-09T14:04:03.364095Z&quot;}" data-trusted="true" data-execution_count="19">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>LB <span class="op">=</span> LabelBinarizer()</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>train_Y <span class="op">=</span> LB.fit_transform(train_Y)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>val_Y <span class="op">=</span> LB.fit_transform(val_Y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-11-09T14:04:03.560996Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-11-09T14:04:03.560665Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-11-09T14:04:04.113958Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-11-09T14:04:04.113182Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-11-09T14:04:03.560962Z&quot;}" data-trusted="true" data-execution_count="20">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>train_X <span class="op">=</span> np.array(train_X)<span class="op">/</span><span class="fl">255.0</span> <span class="co"># Ubah tipe data train_X dari list menjadi numpy.array dan ubah rentang nilai pixel dari 0-255 menjadi 0-1</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>train_X <span class="op">=</span> train_X.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">32</span>,<span class="dv">32</span>,<span class="dv">1</span>) <span class="co"># Ubah dimensi numpy.array dari (jumlah array, 32, 32) menjadi (jumlah array, 32, 32, 1)</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>train_Y <span class="op">=</span> np.array(train_Y) <span class="co"># Ubah tipe data train_Y dari list menjadi numpy.array</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-11-09T14:04:04.115628Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-11-09T14:04:04.115261Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-11-09T14:04:04.182401Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-11-09T14:04:04.181446Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-11-09T14:04:04.115591Z&quot;}" data-trusted="true" data-execution_count="21">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>val_X <span class="op">=</span> np.array(val_X)<span class="op">/</span><span class="fl">255.0</span> <span class="co"># Ubah tipe data val_X dari list menjadi numpy.array dan ubah rentang nilai pixel dari 0-255 menjadi 0-1</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>val_X <span class="op">=</span> val_X.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">32</span>,<span class="dv">32</span>,<span class="dv">1</span>) <span class="co"># Ubah dimensi numpy.array dari (jumlah array, 32, 32) menjadi (jumlah array, 32, 32, 1)</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>val_Y <span class="op">=</span> np.array(val_Y) <span class="co"># Ubah tipe data val_Y dari list menjadi numpy.array</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-11-09T14:04:04.184050Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-11-09T14:04:04.183717Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-11-09T14:04:04.189997Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-11-09T14:04:04.189101Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-11-09T14:04:04.184008Z&quot;}" data-trusted="true" data-execution_count="22">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(train_X.shape,val_X.shape) <span class="co"># Tampilkan hasil reshape</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(140000, 32, 32, 1) (15209, 32, 32, 1)</code></pre>
</div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-11-09T14:04:04.191877Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-11-09T14:04:04.191365Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-11-09T14:04:04.200974Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-11-09T14:04:04.200175Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-11-09T14:04:04.191840Z&quot;}" data-trusted="true" data-execution_count="23">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(train_Y.shape,val_Y.shape) <span class="co"># Tampilkan hasil reshape</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(140000, 35) (15209, 35)</code></pre>
</div>
</div>
<p>Bangun model arsitektur neural network yang dibuat. Pada kasus ini, karena kita menghadapi kasus image recognition maka saya akan menggunakan model sequential menggunakan CNN(Convolutional Neural Network)</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-11-09T14:04:04.202963Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-11-09T14:04:04.202355Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-11-09T14:04:09.157994Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-11-09T14:04:09.157255Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-11-09T14:04:04.202924Z&quot;}" data-trusted="true" data-execution_count="24">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>model.add(Conv2D(<span class="dv">32</span>, (<span class="dv">3</span>, <span class="dv">3</span>), padding <span class="op">=</span> <span class="st">"same"</span>, activation<span class="op">=</span><span class="st">'relu'</span>, input_shape<span class="op">=</span>(<span class="dv">32</span>,<span class="dv">32</span>,<span class="dv">1</span>)))</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>model.add(MaxPooling2D(pool_size<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">2</span>)))</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>model.add(Conv2D(<span class="dv">64</span>, (<span class="dv">3</span>, <span class="dv">3</span>), activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>model.add(MaxPooling2D(pool_size<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">2</span>)))</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>model.add(Conv2D(<span class="dv">128</span>, (<span class="dv">3</span>, <span class="dv">3</span>), activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>model.add(MaxPooling2D(pool_size<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">2</span>)))</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>model.add(Dropout(<span class="fl">0.25</span>))</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>model.add(Flatten())</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">128</span>, activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>model.add(Dropout(<span class="fl">0.2</span>))</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">35</span>, activation<span class="op">=</span><span class="st">'softmax'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-11-09T14:04:09.159561Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-11-09T14:04:09.159230Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-11-09T14:04:09.172321Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-11-09T14:04:09.171013Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-11-09T14:04:09.159517Z&quot;}" data-trusted="true" data-execution_count="25">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>model.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 32, 32, 32)        320       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 16, 16, 32)        0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 14, 14, 64)        18496     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 7, 7, 64)          0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 5, 5, 128)         73856     
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 2, 2, 128)         0         
_________________________________________________________________
dropout (Dropout)            (None, 2, 2, 128)         0         
_________________________________________________________________
flatten (Flatten)            (None, 512)               0         
_________________________________________________________________
dense (Dense)                (None, 128)               65664     
_________________________________________________________________
dropout_1 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 35)                4515      
=================================================================
Total params: 162,851
Trainable params: 162,851
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-11-09T14:04:09.174591Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-11-09T14:04:09.174180Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-11-09T14:04:09.188007Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-11-09T14:04:09.187403Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-11-09T14:04:09.174507Z&quot;}" data-trusted="true" data-execution_count="26">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(loss<span class="op">=</span><span class="st">'categorical_crossentropy'</span>, optimizer<span class="op">=</span><span class="st">"adam"</span>,metrics<span class="op">=</span>[<span class="st">'accuracy'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-11-09T14:04:09.189676Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-11-09T14:04:09.189320Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-11-09T14:14:38.762924Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-11-09T14:14:38.762002Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-11-09T14:04:09.189637Z&quot;}" data-trusted="true" data-execution_count="27">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> model.fit(train_X,train_Y, epochs<span class="op">=</span><span class="dv">50</span>, batch_size<span class="op">=</span><span class="dv">32</span>, validation_data <span class="op">=</span> (val_X, val_Y),  verbose<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/50
4375/4375 [==============================] - 13s 3ms/step - loss: 0.6208 - accuracy: 0.8020 - val_loss: 0.2941 - val_accuracy: 0.9089
Epoch 2/50
4375/4375 [==============================] - 13s 3ms/step - loss: 0.3500 - accuracy: 0.8819 - val_loss: 0.3439 - val_accuracy: 0.8565
Epoch 3/50
4375/4375 [==============================] - 12s 3ms/step - loss: 0.3044 - accuracy: 0.8957 - val_loss: 0.2723 - val_accuracy: 0.9011
Epoch 4/50
4375/4375 [==============================] - 12s 3ms/step - loss: 0.2779 - accuracy: 0.9039 - val_loss: 0.2713 - val_accuracy: 0.8966
Epoch 5/50
4375/4375 [==============================] - 13s 3ms/step - loss: 0.2639 - accuracy: 0.9083 - val_loss: 0.2434 - val_accuracy: 0.9143
Epoch 6/50
4375/4375 [==============================] - 12s 3ms/step - loss: 0.2493 - accuracy: 0.9123 - val_loss: 0.2556 - val_accuracy: 0.8985
Epoch 7/50
4375/4375 [==============================] - 13s 3ms/step - loss: 0.2389 - accuracy: 0.9159 - val_loss: 0.2454 - val_accuracy: 0.9066
Epoch 8/50
4375/4375 [==============================] - 12s 3ms/step - loss: 0.2319 - accuracy: 0.9179 - val_loss: 0.2186 - val_accuracy: 0.9262
Epoch 9/50
4375/4375 [==============================] - 12s 3ms/step - loss: 0.2238 - accuracy: 0.9208 - val_loss: 0.2383 - val_accuracy: 0.9112
Epoch 10/50
4375/4375 [==============================] - 13s 3ms/step - loss: 0.2207 - accuracy: 0.9211 - val_loss: 0.2343 - val_accuracy: 0.9181
Epoch 11/50
4375/4375 [==============================] - 12s 3ms/step - loss: 0.2138 - accuracy: 0.9231 - val_loss: 0.2421 - val_accuracy: 0.9163
Epoch 12/50
4375/4375 [==============================] - 13s 3ms/step - loss: 0.2090 - accuracy: 0.9247 - val_loss: 0.2305 - val_accuracy: 0.9211
Epoch 13/50
4375/4375 [==============================] - 12s 3ms/step - loss: 0.2050 - accuracy: 0.9257 - val_loss: 0.2343 - val_accuracy: 0.9136
Epoch 14/50
4375/4375 [==============================] - 12s 3ms/step - loss: 0.2039 - accuracy: 0.9256 - val_loss: 0.2425 - val_accuracy: 0.9108
Epoch 15/50
4375/4375 [==============================] - 13s 3ms/step - loss: 0.1992 - accuracy: 0.9274 - val_loss: 0.2435 - val_accuracy: 0.9128
Epoch 16/50
4375/4375 [==============================] - 12s 3ms/step - loss: 0.1964 - accuracy: 0.9288 - val_loss: 0.2448 - val_accuracy: 0.9131
Epoch 17/50
4375/4375 [==============================] - 13s 3ms/step - loss: 0.1952 - accuracy: 0.9284 - val_loss: 0.2377 - val_accuracy: 0.9224
Epoch 18/50
4375/4375 [==============================] - 12s 3ms/step - loss: 0.1895 - accuracy: 0.9294 - val_loss: 0.2416 - val_accuracy: 0.9217
Epoch 19/50
4375/4375 [==============================] - 12s 3ms/step - loss: 0.1877 - accuracy: 0.9304 - val_loss: 0.2437 - val_accuracy: 0.9211
Epoch 20/50
4375/4375 [==============================] - 13s 3ms/step - loss: 0.1848 - accuracy: 0.9310 - val_loss: 0.2383 - val_accuracy: 0.9223
Epoch 21/50
4375/4375 [==============================] - 12s 3ms/step - loss: 0.1833 - accuracy: 0.9326 - val_loss: 0.2464 - val_accuracy: 0.9152
Epoch 22/50
4375/4375 [==============================] - 13s 3ms/step - loss: 0.1839 - accuracy: 0.9316 - val_loss: 0.2564 - val_accuracy: 0.9116
Epoch 23/50
4375/4375 [==============================] - 12s 3ms/step - loss: 0.1805 - accuracy: 0.9325 - val_loss: 0.2408 - val_accuracy: 0.9220
Epoch 24/50
4375/4375 [==============================] - 12s 3ms/step - loss: 0.1818 - accuracy: 0.9327 - val_loss: 0.2503 - val_accuracy: 0.9175
Epoch 25/50
4375/4375 [==============================] - 13s 3ms/step - loss: 0.1793 - accuracy: 0.9332 - val_loss: 0.2443 - val_accuracy: 0.9227
Epoch 26/50
4375/4375 [==============================] - 12s 3ms/step - loss: 0.1770 - accuracy: 0.9336 - val_loss: 0.2488 - val_accuracy: 0.9200
Epoch 27/50
4375/4375 [==============================] - 13s 3ms/step - loss: 0.1749 - accuracy: 0.9345 - val_loss: 0.2566 - val_accuracy: 0.9070
Epoch 28/50
4375/4375 [==============================] - 12s 3ms/step - loss: 0.1773 - accuracy: 0.9334 - val_loss: 0.2423 - val_accuracy: 0.9250
Epoch 29/50
4375/4375 [==============================] - 12s 3ms/step - loss: 0.1756 - accuracy: 0.9345 - val_loss: 0.2576 - val_accuracy: 0.9145
Epoch 30/50
4375/4375 [==============================] - 13s 3ms/step - loss: 0.1731 - accuracy: 0.9362 - val_loss: 0.2417 - val_accuracy: 0.9228
Epoch 31/50
4375/4375 [==============================] - 12s 3ms/step - loss: 0.1717 - accuracy: 0.9358 - val_loss: 0.2507 - val_accuracy: 0.9208
Epoch 32/50
4375/4375 [==============================] - 13s 3ms/step - loss: 0.1743 - accuracy: 0.9349 - val_loss: 0.2572 - val_accuracy: 0.9119
Epoch 33/50
4375/4375 [==============================] - 12s 3ms/step - loss: 0.1710 - accuracy: 0.9361 - val_loss: 0.2564 - val_accuracy: 0.9172
Epoch 34/50
4375/4375 [==============================] - 12s 3ms/step - loss: 0.1715 - accuracy: 0.9355 - val_loss: 0.2544 - val_accuracy: 0.9172
Epoch 35/50
4375/4375 [==============================] - 13s 3ms/step - loss: 0.1689 - accuracy: 0.9365 - val_loss: 0.2629 - val_accuracy: 0.9195
Epoch 36/50
4375/4375 [==============================] - 12s 3ms/step - loss: 0.1695 - accuracy: 0.9359 - val_loss: 0.2575 - val_accuracy: 0.9166
Epoch 37/50
4375/4375 [==============================] - 12s 3ms/step - loss: 0.1696 - accuracy: 0.9366 - val_loss: 0.2614 - val_accuracy: 0.9175
Epoch 38/50
4375/4375 [==============================] - 12s 3ms/step - loss: 0.1685 - accuracy: 0.9362 - val_loss: 0.2812 - val_accuracy: 0.9041
Epoch 39/50
4375/4375 [==============================] - 12s 3ms/step - loss: 0.1645 - accuracy: 0.9378 - val_loss: 0.2544 - val_accuracy: 0.9197
Epoch 40/50
4375/4375 [==============================] - 13s 3ms/step - loss: 0.1666 - accuracy: 0.9377 - val_loss: 0.2621 - val_accuracy: 0.9172
Epoch 41/50
4375/4375 [==============================] - 12s 3ms/step - loss: 0.1671 - accuracy: 0.9374 - val_loss: 0.2648 - val_accuracy: 0.9181
Epoch 42/50
4375/4375 [==============================] - 13s 3ms/step - loss: 0.1639 - accuracy: 0.9380 - val_loss: 0.2651 - val_accuracy: 0.9087
Epoch 43/50
4375/4375 [==============================] - 12s 3ms/step - loss: 0.1652 - accuracy: 0.9383 - val_loss: 0.2764 - val_accuracy: 0.9122
Epoch 44/50
4375/4375 [==============================] - 12s 3ms/step - loss: 0.1649 - accuracy: 0.9380 - val_loss: 0.2562 - val_accuracy: 0.9250
Epoch 45/50
4375/4375 [==============================] - 13s 3ms/step - loss: 0.1654 - accuracy: 0.9379 - val_loss: 0.2498 - val_accuracy: 0.9273
Epoch 46/50
4375/4375 [==============================] - 12s 3ms/step - loss: 0.1650 - accuracy: 0.9387 - val_loss: 0.2623 - val_accuracy: 0.9233
Epoch 47/50
4375/4375 [==============================] - 13s 3ms/step - loss: 0.1629 - accuracy: 0.9388 - val_loss: 0.2570 - val_accuracy: 0.9244
Epoch 48/50
4375/4375 [==============================] - 12s 3ms/step - loss: 0.1623 - accuracy: 0.9392 - val_loss: 0.2640 - val_accuracy: 0.9185
Epoch 49/50
4375/4375 [==============================] - 12s 3ms/step - loss: 0.1619 - accuracy: 0.9394 - val_loss: 0.2802 - val_accuracy: 0.9105
Epoch 50/50
4375/4375 [==============================] - 13s 3ms/step - loss: 0.1630 - accuracy: 0.9395 - val_loss: 0.2605 - val_accuracy: 0.9200</code></pre>
</div>
</div>
<p>Kode dibawah ini akan menampilkan plot tingkat akurasi model pada setiap epoch ketika diuji menggunakan data Train(garis biru) dan Validation(Garis Kuning)</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-11-09T14:14:38.765011Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-11-09T14:14:38.764662Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-11-09T14:14:39.064132Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-11-09T14:14:39.063022Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-11-09T14:14:38.764976Z&quot;}" data-trusted="true" data-execution_count="28">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>plt.plot(history.history[<span class="st">'accuracy'</span>])</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>plt.plot(history.history[<span class="st">'val_accuracy'</span>])</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Training Accuracy vs Validation Accuracy'</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Accuracy'</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Epoch'</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">'Train'</span>, <span class="st">'Validation'</span>], loc<span class="op">=</span><span class="st">'upper left'</span>)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-09-18-Optical-Character-Recognition_files/figure-html/cell-19-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Kode dibawah ini akan menampilkan plot Loss model pada setiap epoch ketika diuji menggunakan data Train(garis biru) dan Validation(Garis Kuning)</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-11-09T14:14:39.065891Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-11-09T14:14:39.065457Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-11-09T14:14:39.201936Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-11-09T14:14:39.200822Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-11-09T14:14:39.065849Z&quot;}" data-trusted="true" data-execution_count="29">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>plt.plot(history.history[<span class="st">'loss'</span>])</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>plt.plot(history.history[<span class="st">'val_loss'</span>])</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Training Loss vs Validation Loss'</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Loss'</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Epoch'</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">'Train'</span>, <span class="st">'Validation'</span>], loc<span class="op">=</span><span class="st">'upper left'</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-09-18-Optical-Character-Recognition_files/figure-html/cell-20-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="recognition-and-post-processing" class="level2">
<h2 class="anchored" data-anchor-id="recognition-and-post-processing">Recognition and Post-Processing</h2>
<ol type="1">
<li>Fungsi sort contuour berfungsi untuk mendapatkan urutan yang tepat untuk setiap karakter atau huruf pada sebuah gambar. Pada kasus ini fungsi ini akan mencoba meng-extrack setiap huruf yang ada pada gambar sesuai urutan dari kiri ke kanan.</li>
<li>Fungsi get letter adalah mengumpulkan setiap contour huruf pada pada gambar dan melakukan prediksi dengan menggunakan model yang telah dibangun untuk setiap huruf sehingga membentuk sebuah kata</li>
</ol>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-11-09T14:14:39.203710Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-11-09T14:14:39.203348Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-11-09T14:14:39.211114Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-11-09T14:14:39.210096Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-11-09T14:14:39.203672Z&quot;}" data-trusted="true" data-execution_count="30">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sort_contours(cnts, method<span class="op">=</span><span class="st">"left-to-right"</span>):</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    reverse <span class="op">=</span> <span class="va">False</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    i <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> method <span class="op">==</span> <span class="st">"right-to-left"</span> <span class="kw">or</span> method <span class="op">==</span> <span class="st">"bottom-to-top"</span>:</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>        reverse <span class="op">=</span> <span class="va">True</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> method <span class="op">==</span> <span class="st">"top-to-bottom"</span> <span class="kw">or</span> method <span class="op">==</span> <span class="st">"bottom-to-top"</span>:</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>        i <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    boundingBoxes <span class="op">=</span> [cv2.boundingRect(c) <span class="cf">for</span> c <span class="kw">in</span> cnts]</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    (cnts, boundingBoxes) <span class="op">=</span> <span class="bu">zip</span>(<span class="op">*</span><span class="bu">sorted</span>(<span class="bu">zip</span>(cnts, boundingBoxes),</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    key<span class="op">=</span><span class="kw">lambda</span> b:b[<span class="dv">1</span>][i], reverse<span class="op">=</span>reverse))</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (cnts, boundingBoxes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-11-09T14:14:39.213162Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-11-09T14:14:39.212774Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-11-09T14:14:39.226830Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-11-09T14:14:39.225791Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-11-09T14:14:39.213117Z&quot;}" data-trusted="true" data-execution_count="31">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_letters(img):</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    letters <span class="op">=</span> []</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    image <span class="op">=</span> cv2.imread(img)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    gray <span class="op">=</span> cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    ret,thresh1 <span class="op">=</span> cv2.threshold(gray ,<span class="dv">127</span>,<span class="dv">255</span>,cv2.THRESH_BINARY_INV)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    dilated <span class="op">=</span> cv2.dilate(thresh1, <span class="va">None</span>, iterations<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    cnts <span class="op">=</span> cv2.findContours(dilated.copy(), cv2.RETR_EXTERNAL,cv2.CHAIN_APPROX_SIMPLE)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    cnts <span class="op">=</span> imutils.grab_contours(cnts)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    cnts <span class="op">=</span> sort_contours(cnts, method<span class="op">=</span><span class="st">"left-to-right"</span>)[<span class="dv">0</span>]</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Untuk setiap contour lakukan prediksi huruf menggunakan model tensorflow</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> c <span class="kw">in</span> cnts:</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> cv2.contourArea(c) <span class="op">&gt;</span> <span class="dv">10</span>:</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>            (x, y, w, h) <span class="op">=</span> cv2.boundingRect(c)</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>            cv2.rectangle(image, (x, y), (x <span class="op">+</span> w, y <span class="op">+</span> h), (<span class="dv">0</span>, <span class="dv">255</span>, <span class="dv">0</span>), <span class="dv">2</span>)</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>        roi <span class="op">=</span> gray[y:y <span class="op">+</span> h, x:x <span class="op">+</span> w]</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>        thresh <span class="op">=</span> cv2.threshold(roi, <span class="dv">0</span>, <span class="dv">255</span>,cv2.THRESH_BINARY_INV <span class="op">|</span> cv2.THRESH_OTSU)[<span class="dv">1</span>]</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>        thresh <span class="op">=</span> cv2.resize(thresh, (<span class="dv">32</span>, <span class="dv">32</span>), interpolation <span class="op">=</span> cv2.INTER_CUBIC)</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>        thresh <span class="op">=</span> thresh.astype(<span class="st">"float32"</span>) <span class="op">/</span> <span class="fl">255.0</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>        thresh <span class="op">=</span> np.expand_dims(thresh, axis<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>        thresh <span class="op">=</span> thresh.reshape(<span class="dv">1</span>,<span class="dv">32</span>,<span class="dv">32</span>,<span class="dv">1</span>)</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>        ypred <span class="op">=</span> model.predict(thresh)</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>        ypred <span class="op">=</span> LB.inverse_transform(ypred)</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>        [x] <span class="op">=</span> ypred</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>        letters.append(x)</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> letters, image</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-11-09T14:14:39.228486Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-11-09T14:14:39.228142Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-11-09T14:14:39.243595Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-11-09T14:14:39.242735Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-11-09T14:14:39.228451Z&quot;}" data-trusted="true" data-execution_count="32">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fungsi ini dibuat untuk menggabungkan semua list prediksi huruf menjadi sebuah kata</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_word(letter):</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    word <span class="op">=</span> <span class="st">""</span>.join(letter)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> word</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-11-09T14:30:43.455204Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-11-09T14:30:43.454745Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-11-09T14:30:43.857836Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-11-09T14:30:43.857032Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-11-09T14:30:43.455166Z&quot;}" data-trusted="true" data-execution_count="57">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>letter,image <span class="op">=</span> get_letters(<span class="st">"../input/handwriting-recognition/train_v2/train/TRAIN_00020.jpg"</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>word <span class="op">=</span> get_word(letter)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(word)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>plt.imshow(image)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R0ML1N</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="57">
<pre><code>&lt;matplotlib.image.AxesImage at 0x7f6924668710&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2022-09-18-Optical-Character-Recognition_files/figure-html/cell-24-output-3.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-11-09T14:14:40.101789Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-11-09T14:14:40.101407Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-11-09T14:14:40.443811Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-11-09T14:14:40.443156Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-11-09T14:14:40.101748Z&quot;}" data-trusted="true" data-execution_count="35">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>letter,image <span class="op">=</span> get_letters(<span class="st">"../input/handwriting-recognition/train_v2/train/TRAIN_00030.jpg"</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>word <span class="op">=</span> get_word(letter)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(word)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>plt.imshow(image)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>IAFFFLX</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>&lt;matplotlib.image.AxesImage at 0x7f69a00664d0&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2022-09-18-Optical-Character-Recognition_files/figure-html/cell-25-output-3.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-11-09T14:14:40.445754Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-11-09T14:14:40.445405Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-11-09T14:14:40.700769Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-11-09T14:14:40.700147Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-11-09T14:14:40.445718Z&quot;}" data-trusted="true" data-execution_count="36">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>letter,image <span class="op">=</span> get_letters(<span class="st">"../input/handwriting-recognition/validation_v2/validation/VALIDATION_0005.jpg"</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>word <span class="op">=</span> get_word(letter)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(word)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>plt.imshow(image)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>RUPP</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>&lt;matplotlib.image.AxesImage at 0x7f69a0201550&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2022-09-18-Optical-Character-Recognition_files/figure-html/cell-26-output-3.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-11-09T14:14:40.702967Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-11-09T14:14:40.702488Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-11-09T14:14:41.134817Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-11-09T14:14:41.134005Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-11-09T14:14:40.702913Z&quot;}" data-trusted="true" data-execution_count="37">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>letter,image <span class="op">=</span> get_letters(<span class="st">"../input/handwriting-recognition/test_v2/test/TEST_0007.jpg"</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>word <span class="op">=</span> get_word(letter)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(word)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>plt.imshow(image)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>VFLENTJNE</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>&lt;matplotlib.image.AxesImage at 0x7f69a0226590&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2022-09-18-Optical-Character-Recognition_files/figure-html/cell-27-output-3.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="kekurangan" class="level2">
<h2 class="anchored" data-anchor-id="kekurangan">Kekurangan</h2>
<ol type="1">
<li>Pada tahap recognition sangat tergantung kepada contour detection dari library opencv, jadi jika opencv tidak dapat menemukan contour huruf maka metode ini akan gagal.</li>
<li>Ada banyak variasi huruf untuk setiap tulisan huruf, sehingga masih banyak contoh yang diperlukan untuk melakukan training pada model ini.</li>
<li>Model ini tidak akan berhasil jika digunakan pada huruf jalan atau sambung.</li>
</ol>
</section>
<section id="kesimpulan" class="level2">
<h2 class="anchored" data-anchor-id="kesimpulan">Kesimpulan</h2>
<p>Pada artikel ini kita telah membahas bagaimana pendekatan character segmentation dan classification dapat digunakan untuk membuat sebuah OCR (Optical Character Recognition) untuk tulisan tangan. Untuk meningkatkan performa model ini, lebih banyak dataset diperlukan untuk pada proses training untuk mendapatkan performa yang lebih baik.</p>
</section>
<section id="referensi" class="level2">
<h2 class="anchored" data-anchor-id="referensi">Referensi</h2>
<ol type="1">
<li><a href="http://">https://www.pyimagesearch.com/2020/08/24/ocr-handwriting-recognition-with-opencv-keras-and-tensorflow/</a></li>
<li><a href="http://">https://www.pyimagesearch.com/2015/04/20/sorting-contours-using-python-and-opencv/</a></li>
</ol>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>